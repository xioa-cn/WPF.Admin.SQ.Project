<UserControl
    x:Class="WPF.Admin.Themes.I18n.ChangeLangs"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:WPF.Admin.Themes.I18n"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    d:DataContext="{d:DesignInstance Type=local:IChangeLangable}"
    d:DesignHeight="40"
    d:DesignWidth="80"
    mc:Ignorable="d">
    <UserControl.Resources>
        <DropShadowEffect
            x:Key="DropShadowEffect"
            BlurRadius="5"
            Opacity="0.3"
            ShadowDepth="2" />
    </UserControl.Resources>
    <Grid>
        <!--  当前语言显示文本块  -->
        <TextBlock
            x:Name="langTextBlock"
            Padding="10,6"
            HorizontalAlignment="Center"
            VerticalAlignment="Center"
            Cursor="Hand"
            FontSize="14"
            FontWeight="Medium"
            Foreground="{DynamicResource Text.Primary.Brush}"
            MouseLeave="LangTextBlock_MouseLeave"
            PreviewMouseDown="LangTextBlock_PreviewMouseDown"
            Text="{Binding Lang}"
            ToolTip="点击切换语言">
            <TextBlock.RenderTransform>
                <TranslateTransform x:Name="textTransform" />
            </TextBlock.RenderTransform>
        </TextBlock>

        <!--  语言选择弹出层  -->
        <Popup
            x:Name="langPopup"
            AllowsTransparency="True"
            Placement="MousePoint"
            PopupAnimation="Fade"
            StaysOpen="True">
            <Popup.RenderTransform>
                <TranslateTransform Y="-5" />
            </Popup.RenderTransform>

            <!--  弹出层内容  -->
            <Border
                Width="200"
                Padding="0"
                BorderThickness="1"
                CornerRadius="8"
                Effect="{StaticResource DropShadowEffect}">
                <!--  标题栏  -->
                <StackPanel>
                    <Grid>
                        <TextBlock
                            Padding="16,12,16,8"
                            FontSize="12"
                            FontWeight="Medium"
                            Foreground="{DynamicResource Text.Primary.Brush}"
                            Text="选择语言" />
                        <Button
                            Height="10"
                            Margin="16,12,16,8"
                            HorizontalAlignment="Right"
                            Background="Red"
                            Click="ClosePopup" />
                    </Grid>
                    <!--  分隔线  -->
                    <Border Height="1" Background="{DynamicResource Border.Brush}" />

                    <!--  语言列表  -->
                    <ItemsControl Margin="0,0,0,3" ItemsSource="{Binding Langs}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <StackPanel />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Button
                                    Width="180"
                                    Margin="0,3,0,0"
                                    Click="ClosePopup"
                                    Command="{Binding RelativeSource={RelativeSource AncestorType=ItemsControl}, Path=DataContext.ChangeLangCommand}"
                                    CommandParameter="{Binding SourceKey}"
                                    Content="{Binding Name}"
                                    Style="{StaticResource ButtonPrimary}" />
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </Border>
        </Popup>
    </Grid>

</UserControl>
